<!DOCTYPE html>
<html>
	<head>
		<script src="javascripts/flot/jquery.js"></script>
		<script src="javascripts/jqmath/jqmath-etc-0.2.0.min.js"></script>
		<link rel="stylesheet" href="javascripts/jqmath/jqmath-0.2.0.css">
		<link rel="stylesheet" type="text/css" media="screen" href="stylesheets/style.css">
		<title>Modal Analysis</title>
	</head>

	<body>
		<div id="main">

		<div id="menu">
		<a href="https://github.com/llarsen71/GMA1D"> Git Repository </a>
		</div><!--menu-->

		<div id="title">
		<h1>Generalizing Modal Analysis</h1>
		<div style="padding: 0 0 20px 0; text-align: center;">Lance Larsen</div>
		</div><!--title-->

		<h2>Understanding Physical Systems</h2>

		<p>Many of the laws of physics, such as Newton's laws of motion, are expressed as differential equations. A physical system
		can often be modelled as a system of coupled ordinary differtial equations (ODEs). A good mathematical model is an important
		tool for a scientist or engineer because it help them explore and understand the behavior of a systems better. A good 
		mathematical model can help you tell if a design change results in a system that works better. If you want to improve something,
		it sure helps if you understand it first.</p>

		<p>Developing a good model is an important first step, but in order to understand the model, you need to understand the solutions.
		The solutions to the model depend on the starting state of the system (or initial conditions) and its interaction with its 
		surroundings (bondary conditions). Two different solutions to the system may look very different, and gaining a good understanding
		of how a system behaves under many different conditions can be a difficult challenge.</p>

		<p>Techniques for exploring the behavior of a mathematical model can be divided into <b>quantitative techniques</b> and
		<b>qualitative techniques</b>. The goal of a quantitative technique is to calculate an accurate solution. This can be helpful
		for understanding the behavior of a system better, but doesn't address one important question - will the
		behavior of the system change significantly if I change the boundary or initial conditions? The goal of a qualitative technique
		is to understand the behavioral trends of a system under a range of conditions. Many qualitative techniques require a system to
		be simplified in one way or another in order to identify behavioral trends, or in other words, accuracy is sacrificed in order
		to gain a broader understanding of how the system behaves.</p>

		<h2> Modal Analysis</h2>

		<p>For linear systems, modal analysis is an elegant blend of quantitative and qualitative techniques. It accurately predicts 
		linear system response, but also characterizes the general behavior of the linear system. Modal analysis is the process of
		finding a new coordinate system where the ODEs of the system are decoupled from one another. The new coordinates are called 
		modal coordinates.</p>

		<div class="box-right" style="margin-top: 0em;">
		<h1>Definition</h1>
		<b>Modal Coordinate</b> - A linear function $q(x_1,x_2,...,x_n)$ that when used as a coordinate for a system of ODEs results in a 
		decoupled ODE of the form ${dq}/{dt} = &lambda; q$.
		</div><!--box-right-->

		<p>The quantitative accuracy comes from the fact that the new modal system is the same as the original system - the only difference
		is the coordinate system that is used. The qualitative understanding comes from the fact that modal analysis converts a system 
		where the ODEs are coupled are typically too complex to understand as a whole, to a system that is simple to understand, because 
		the modal ODEs are decoupled and can be solved and explored independently. The modal ODE solutions can be added to get the total system
		response. The power of modal analysis comes from the fact that you can understand the total behavior of the system in terms 
		individual behavior of the modes.<p>

		<p>For nonlinear systems, there is often a region around an equilibrium or steady state solution were a linear system provides a
		good approximation and modal analysis gives good results. However, a linear approximation misses important trends, and cases where
		the response grows to the point where nonlinear terms are important, and modal analysis gives poor results. So while modal analysis
		will remain an important tool for the study of linear and nonlinear systems, there is a need to generalize the approach so that the
		elegant blend of quantitative and qualitative merrits are preserved.</p>

		<h2>Calculating the Modal Equation</h2>

		<p>Before generalizing modal analysis to nonlinear systems, lets talk about how to calculate the modal coordinates which
		decouple a system of ODEs. We will start with a linear system of ODEs expressed in matrix first order form: </p>
		
		<p>(1)&nbsp;&nbsp;&nbsp; ${dx_i}/{dt} = A_{ij} x_j$</p>
		
		<p>Note that in order for modal analysis to work, the value of the coefficients in $A_{ij}$ must not change with time. 
		In other works, the coeffients can be constant values, or constant parameters such as a mass or stiffness quantity. 
		We will explain why this is in the discussion below. The linear modal coordinate function $q$ can be written in the form:</p>
		
		<p>(2)&nbsp;&nbsp;&nbsp; $q = c_i x_i$ </p>

		<p>where $c_i$ is a vector with values that do not depend on $t$.</p>

		<h4>Example System</h4>

		<p>As an example consider the following system:</p>

		<p>${dx_1}/{dt} = -2 x_1 + x_2$<br>
		   ${dx_2}/{dt} = x_1 - 2 x_2$</p>

		<p>Or in Matrix Form:</p>

		<p>$(\table {dx_1}/{dt}; {dx_2}/{dt}) = (\table -2, 1; 1, -2) (\table x_1; x_2)$</p>

		<p> The modal coordinate function in matrix form is written as:</p>

		<p>(3)&nbsp;&nbsp;&nbsp; $q = (\table c_1, c_2) (\table x_1; x_2) = c_1 x_1 + c_2 x_2$</p>

		<p>To calculate a modal coordinate of a system of ODEs, we do the following:

		<h3>Step 1 - Calculate an Eigenvector</h3>

		<p>The first step for determining a modal coordinate is to calculate a left eigenvector $c_i$. A left eigenvector 
		a vector that solves the equation:</p>

		<p>(4)&nbsp;&nbsp;&nbsp; $c_i A_{ij} = &lambda; c_j$</p>

		<p>This is called a left eigenvector because it is an eigenvector calculated by multiplying the matrix $A_{ij}$ by a
		row vector $c_i$ on the left side.</p>

		<h4>Step 1 Example</h4>

		<p>For the example system above the left eigenvector equation is:</p>

		<p>$(\table c_1, c_2) (\table -2, 1; 1, -2) = &lambda; (\table c_1, c_2)$</p>

		<p>The associated algebraic equations are:</p>

		<p><table style="margin-left: 1em"><tr><td align="right">$-2 c_1 + c_2 =$</td><td> $&lambda; c_1$</td></tr>
		   <tr><td align="right">$c_1 - 2 c_2 =$</td><td>$&lambda; c_2$</td></tr></table></p>

		<h4><a name="modes">Modes of the Example System</a></h4>
		<p>The above algebraic equations have two (modal coordinate) solutions which can be found with a little algebra:</p>
		
		<hr>
		<table>
		<tr><td><div class="box"><b>Mode&nbsp;1</b></div> <div class="pad"></td><td>$&lambda; = -1$ and $(\table c_1, c_2) = (\table s, s)$ where $s$ is a real number. From this we get $q_1 = s x_1 + s x_2$</td></tr>
		</table>
		<hr>
		<table>
		<tr><td><div class="box"><b>Mode&nbsp;2</b></div> <div class="pad"></td><td>$&lambda; = -3$ and $(\table c_1, c_2) = (\table s, -s)$  where $s$ is a real number. From this we get we get $q_2 = s x_1 - s x_2$</td></tr>
		</table>
		<hr>
		</p>
		<p>For modal analysis, the arbitrary constant $s$ is typically set of some specific value.</p>

		<h3>Step 2 - Left Multiply the System of ODEs by the Eigenvector</h3>

		<p>Left multiplying the system of ODEs from equation (1) by the eigenvector $c_i$ and applying the eigenvector
		equation from (4) gives:</p>
		
		<p>(5)&nbsp;&nbsp;&nbsp; $c_i {dx_i}/{dt} = c_i A_{ij} x_j = &lambda; c_i x_i$ </p>

		<h4>Step 2 Example</h4>

		<hr>
		<table>
		<tr><td><div class="box"><b>Mode&nbsp;1</b></div> </td><td>$(\table s, s) (\table {dx_1}/{dt}; {dx_2}/{dt}) = -1 (\table s, s) (\table x_1; x_2)$</td></tr>
		</table>
		<hr>
		<table>
		<tr><td><div class="box"><b>Mode&nbsp;2</b></div> </td><td>$(\table s, -s) (\table {dx_1}/{dt}; {dx_2}/{dt}) = -3 (\table s, -s) (\table x_1; x_2)$</td></tr>
		</table>
		<hr>

		<h3>Step 3 - Bring the Left Hand Side Eigenvector inside the Derivative</h3>

		<p>Since the coefficient in $c_i$ are contant relative to $t$, we can insert $c_i$ into the differential on the 
		left hand side of the equation. This is important because it results in the produce $c_i x_i$ inside the differential,
		which equals $q$ [see equation (2)].</p>

		<p>(6)&nbsp;&nbsp;&nbsp; ${d(c_i x_i)}/{dt} = &lambda; c_i x_i$ </p>

		<h4>Step 3 Example</h4>

		<hr>
		<table>
		<tr><td><div class="box"><b>Mode&nbsp;1</b></div></td><td> ${d}/{dt} ((\table s, s) (\table x_1; x_2)) = -1 (\table s, s) (\table x_1; x_2)$ &nbsp;&nbsp; &rArr; &nbsp;&nbsp;  ${d}/{dt} (s x_1 + s x_2) = -1 (s x_1 + s x_2)$</td></tr>
		</table>
		<hr>
		<table>
		<tr><td><div class="box"><b>Mode&nbsp;2</b></div></td><td> ${d}/{dt} ((\table s, -s) (\table x_1; x_2)) = -3 (\table s, -s) (\table x_1; x_2)$ &nbsp;&nbsp; &rArr; &nbsp;&nbsp;  ${d}/{dt} (s x_1 - s x_2) = -3 (s x_1 - s x_2)$</td></tr>
		</table>
		<hr>

		<h3>Step 4 - Substitute in the Modal Coordinate</h3>
		
		<p>Both the left and right hand side of equation (6) now contain the product $c_i x_i$. From equation (2) this can
		be replaced by $q$ to get the decoupled modal ODE:</p>
		
		<p>(7)&nbsp;&nbsp;&nbsp; ${dq}/{dt} = &lambda; q$</p>
		
		<h4><a name="eqn">Step 4 Example - Modal Equations</a></h4>

		<hr>
		<table>
		<tr><td><div class="box"><b>Mode&nbsp;1</b></div></td><td>${dq_1}/{dt} = -q_1$</td></tr>
		</table>
		<hr>
		<table>
		<tr><td><div class="box"><b>Mode&nbsp;2</b></div></td><td> ${dq_2}/{dt} = -3 q$</td></tr>
		</table>
		<hr>

		<h2>The Solution</h2>

		<p>The solution of the modal equation is $q = C e^{&lambda; t}$ where $C$ is an arbitrary constant determined by
		initial conditions.</p>
		
		<h4>Solution for the Example Problem</h4>

		<hr>
		<table>
		<tr><td><div class="box"><b>Mode&nbsp;1</b></div></td><td> $q_1 = C_1 e^{-t}$</td></tr>
		</table>
		<hr>
		<table>
		<tr><td><div class="box"><b>Mode&nbsp;2</b></div></td><td> $q_2 = C_2 e^{-3t}$</td></tr>
		</table>
		<hr>

		<h2>Nonlinear Systems</h2>
		
		<p>The steps outlined above do not result in a decoupled ODE for nonlinear systems. The problem is that some of the
		coefficients in the matrix $A_{ij}$ will be functions of $x_1, x_2, ..., x_n$. This means the eigenvectors will also
		depend on these variables. Since $x_1, x_2, ..., x_n$ change with $t$, the eigenvectors $c_i$ have a dependence on $t$, 
		and the process fails at step 3 because a terms that changes with $t$ can't be brought inside the derivative term. 
		Since we can bring $c_i$ inside the derivative, we don't have the product $c_i x_i$ on the left hand side of the 
		equation, so we can't replace the $c_i$ and $x_i$ with $q$, and the process for decoupling the ODE fails.</p>
		
		<p>So how do we fix this issue for nonlinear systems? Well, it turns out that for linear systems, the step shown above
		are a combination of the <b>chain rule</b> along with a decoupling condition, although this isn't obvious. The chain rule is
		the general rule for applying a change of coordinates to any system of ODEs - linear or nonlinear. The problem is that
		the steps above are not consistent with the chain rule when we are dealing with a nonlinear system. In order to generalize
		modal analysis to nonlinear systems, the change of coordinates and the decoupling condition should be expressed in a form 
		that is consistent with the chain rule.</p>
		
		<p>Next Topic - <a href="extendModalAnalysis.html">Extending Modal Analysis to Nonlinear Systems</a>
		</p>
		</div><!--main-->
	</body>
</html>
