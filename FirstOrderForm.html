<!DOCTYPE html>
<html>
	<head>
		<script src="javascripts/flot/jquery.js"></script>
		<script src="javascripts/jqmath/jqmath-etc-0.2.0.min.js"></script>
		<link rel="stylesheet" href="javascripts/jqmath/jqmath-0.2.0.css">
		<link rel="stylesheet" type="text/css" media="screen" href="stylesheets/style.css">
		<title>First Order Form</title>
	</head>

	<body>
		<div id="main">

		<div id="menu">
		<a href="https://github.com/llarsen71/GMA1D"> Git Repository </a>
		</div><!--menu-->

		<div id="title">
		<h1>First Order Form</h1>
		</div><!--title-->

		<h2>Converting a System to First Order Form</h2>

		<p>So what do we mean by first order form for a systems of ODEs? A system of ODEs can be written in a few different
		ways that are equivalent. First order form is a way of representing the system of ODEs in which there are no
		derivatives higher than a first derivative. An example of an ODE that is NOT is first order form is:</p>

		<p>(1) ${d^4x_1}/{dt^4} + a{d^3x_1}/{dt^3} + b {d^2x_1}/{dt^2} + c {dx_1}/{dt} + d x_1 = 0$</p>

		<p>There is a simple process that you follow to convert a system to first order form.<p>

		<h3>Step 1 - Identify the Dependent Variables and the Highest Order Derivative for Each</h3>

		<p>First you identify the dependent variables. These are the variables
		that appear in the numerator of the derivate terms. In this case, the only dependent variables is $x_1$. For each 
		dependent variable, you find the highest order derivative. The highest order derivative is ${d^4x}/{dt^4}.$</p>

		<h3>Step 2 - Define a Variable Name for each Derivative less than the Highest Order Derivative</h3>

		<p>You then define a new variable name for each derivative that is less than the highest order derivative for each 
		dependent variable even if the lower order derivatives don't appear in the equation. First assign a variable name to
		the first derivative - in this case ${dx_1}/{dt}$:</p>

		<p>(2) ${dx_1}/{dt} = x_2$</p>

		<p>The second derivative ${d^2x_1}/{dt^2}$ can now be expressed as a first order derivative ${dx_2}/{dt}$. Now define
		new variable name for ${dx_2}/{dt}$.</p>

		<p>(3) ${dx_2}/{dt} = x_3$</p>

		<p>The third order derivate ${d^3x_1}/{dt^3}$ can now be written as the first order derivative ${dx_3}/{dt}$. We
		continue the process of assigning new variable names to derivatives until we have assigned variable names to all 
		derivative less than the highest derivative:</p>

		<p>(4) ${dx_3}/{dt} = x_4$</p>
 
		<h3>Step 3 - Define the Highest Order Derivative as a 1<sup>st</sup> Order Derivative</h3>

		<p>Using the variable associated with the next to last order derivative, the highest order derivative can be written
		as a first order derivative. For the example system:<\p>
		
		<p>(5) ${d^4x_1}/{dt^4} = {dx_4}/{dt}$</p>
		
		<h3>Step 4 - Make Variable Substitutions from Steps 2 and 3 into the Original Equation</h3>
 
		<p>In the original differential equation (1), the highest order derivative is now replaced with the 1<sup>st</sup> 
		order derivative from (5), the lower order derivatives are replaced with the variables defined in step 2 ($x_2$, 
		$x_3$, and $x_4$ in the example case). For first order form, it is common to put the first order derivative term 
		alone on the left hand side of the equation and move all other terms to the right hand side of the equation. 

		<p>${dx_4}/{dt} = -a x_4 - b x_3 - c x_2 - d x_1$</p>

		<h3>Step 5 - Combine the Modified Original Equation with the Derivative Definitions from Step 2</h3>

		<p>A first order system is the original equation as modified in step 4, combined with the derivative definition
		equations defined in step 2:</p>

		<p>${dx_1}/{dt} = x_2$<br>
		   ${dx_2}/{dt} = x_3$<br>
		   ${dx_3}/{dt} = x_4$<br>
		   ${dx_4}/{dt} = -a x_4 - b x_3 - c x_2 - d x_1$</p>

		<p>This can be written in matrix for as:</p>

		<p>(6) ${d}/{dt} |\table x_1;x_2;x_3;x_4| = [\table 0, 1, 0, 0; 0, 0, 1, 0; 0, 0, 0, 1; -d, -c, -b, -a] |\table x_1;x_2;x_3;x_4|$</p>

		<p>The process outlined above applies to both linear and nonlinear systems of ODEs.</p>

		<h2>First Order Form for Matrix Equations</h2> 

		<p>The process for converting a matrix equation with higher order derivatives to first order form is very similar to
		the process shown above. As an example, lets consider a matrix equation like the following:</p>

		<p>(7) ${d^3X}/{dt^3} + \bo B {d^2X}/{dt^2} + \bo C {dX}/{dt}  + \bo D X = 0$</p>

		<p>where $\bo B, \bo C,$ and $\bo D$ are $n&nbsp;&times;&nbsp;n$ matrices and $X$ is the vector:</p>
		
		<p>$X = |\table x_1;x_2;...;x_n|$</p>

		<h3>Step 1 - Identify the Dependent Variables and the Highest Order Vector Derivative</h3>

		<p>In this case, the dependent variables are the vector coordinates in $X$, and the highest order 
		vector derivative is ${d^3X}/{dt^3}$. 

		<h3>Step 2 - Define a Variables for each Vector Derivative less than the Highest Order Derivative</h3>

		<p>There are $n$ vector dimensions, and for each dimension, we define a new variable for each of 
		the first order derivative terms:</p>

		<p>${dx_1}/{dt} = x_{n+1}$<br>
		   ${dx_2}/{dt} = x_{n+2}$<br>
		   ...<br>
		   ${dx_n}/{dt} = x_{2n}$</p>

		<p>We also define a new variable for each of the second order derivative terms:</p>
			 
		<p>${dx_{n+1}}/{dt} = x_{2n+1} = {d^2x_1}/{dt^2}$<br>
		   ${dx_{n+2}}/{dt} = x_{2n+2} = {d^2x_2}/{dt^2}$<br>
		   ...<br>
		   ${dx_{2n}}/{dt} = x_{3n}    = {d^2x_n}/{dt^2}$</p>

		<h3>Step 3 - Define a New Extended Vector that Contains the Derivative Variables From Step 2</h3>
		<p>Now we append the first derivative variables $x_{n+1}$ through $x_{2n}$ and the scond derivative variables 
		$x_{2n+1}$ through $x_{3n}$ to the vector $x$:</p>

		<p>(8) $X = |\table x_1;x_2;...;x_{3n}|$</p>

		<h3>Step 4 - Arrange the Original Equation into a Matrix From based on the Extended Vector</h3>

		<p>If $\bo 0$ is an $n&nbsp;&times;&nbsp;n$ matrix of 0s, and $\bo I$ is an $n&nbsp;&times;&nbsp;n$ identity matrix, then 
		matrix equation (7) can then be written as:</p>

		<p>(9) ${dX}/{dt} = (\table \bo 0, \bo I, \bo 0; \bo 0, \bo 0, \bo I; \bo -D, \bo -C, \bo -B) X$</p>

		<h2>What are the advantages of First Order Form?</h2>

		<p>There are a few of advantages to first order form for a system of differential equations. If forcing terms are not
		included, a linear system in first order form can be written as:</p>

		<p>${dX}/{dt} = \bo A X$</p>

		<p>This is a form that is convenient for applying modal analysis, as discussed on <a href="index.html">this page</a>.
		First order form for applying general coordinate transformations via the chain rule, since the first order terms are
		used in the chain rule. Using the chain rule for coordinate transformations is a important element in generalizing 
		modal analysis to nonlinear systems, as discussed on <a href="extendModalAnalysis.html">this page</a>.</p>

		<p>A third advantage of first order form is geometric. The dependent variable of a system of ODEs in first order form
		are the solution space for the system. If $t$ is used explicitly in the system, then the solution space includes $t$.
		Each point in the solution space belongs to a 1-D solution curve or is an equilibrium point. The ODE equations 
		<a href="extendModalAnalysis.html#vector">can be represented as a vector field</a>, with a vector at each point that
		is tangent to the solution curve.</p>
		</body>
</html>